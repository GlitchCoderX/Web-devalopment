<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reaction Time Tester</title>
  <meta name="description" content="Simple reaction time test. Click or press Space when the screen turns green.">
  <style>
    :root{
      --bg: #0f172a;           /* slate-900 */
      --panel: #111827;        /* gray-900 */
      --text: #e5e7eb;         /* gray-200 */
      --muted: #9ca3af;        /* gray-400 */
      --accent: #22d3ee;       /* cyan-400 */
      --good: #22c55e;         /* green-500 */
      --warn: #f59e0b;         /* amber-500 */
      --bad: #ef4444;          /* red-500 */
      --shadow: 0 10px 20px rgba(0,0,0,.25), 0 2px 6px rgba(0,0,0,.15);
      --radius: 20px;
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 500px at 50% -100px, #1f2937 0%, var(--bg) 60%);
      color: var(--text);
      display: grid; place-items: center;
      padding: 24px;
    }
    .app{
      width: min(900px, 100%);
      display: grid; gap: 18px;
    }
    .card{
      background: linear-gradient(180deg, rgba(255,255,255,0.04), rgba(255,255,255,0.01));
      border: 1px solid rgba(255,255,255,0.06);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow: hidden;
    }
    header.card{ padding: 22px 22px 6px; }
    header h1{ margin:0; font-size: clamp(22px, 3.6vw, 34px); letter-spacing: .4px; }
    header p{ margin: 6px 0 0; color: var(--muted); }

    .grid{ display: grid; gap: 18px; grid-template-columns: 2fr 1fr; }
    @media (max-width: 820px){ .grid{ grid-template-columns: 1fr; } }

    /* Test Area */
    .stage{
      aspect-ratio: 16/9; min-height: 260px;
      display: grid; place-items: center; text-align: center;
      position: relative; cursor: pointer; user-select: none;
      transition: background-color .2s ease, transform .12s ease;
    }
    .stage.idle{ background: #0b1220; }
    .stage.wait{ background: #1f2937; }
    .stage.go{ background: #072d16; }
    .stage.too-soon{ background: #3b0b0b; }

    .stage .msg{
      font-size: clamp(18px, 3.4vw, 28px);
      padding: 10px 16px; border-radius: 999px;
      background: rgba(0,0,0,.3);
      border: 1px solid rgba(255,255,255,.08);
      box-shadow: inset 0 0 0 1px rgba(255,255,255,.04);
    }

    .controls{ display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content: space-between; padding: 14px; border-top: 1px solid rgba(255,255,255,.06); }
    .btn{
      border: 0; border-radius: 999px; padding: 10px 16px; font-weight: 600; letter-spacing: .3px;
      background: var(--accent); color: #00343c; cursor:pointer; transition: transform .08s ease, filter .2s ease, opacity .2s ease;
    }
    .btn:active{ transform: translateY(1px) scale(.98); }
    .btn.secondary{ background: transparent; color: var(--text); border: 1px solid rgba(255,255,255,.14); }
    .hint{ color: var(--muted); font-size: 14px; }

    /* Stats */
    .stats{ display:grid; grid-template-columns: repeat(4,1fr); gap:12px; padding: 16px; }
    .stat{
      background: rgba(255,255,255,.04); border: 1px solid rgba(255,255,255,.06);
      border-radius: 14px; padding: 14px; text-align:center;
    }
    .stat .label{ font-size: 12px; color: var(--muted); text-transform: uppercase; letter-spacing: .12em; }
    .stat .value{ margin-top:6px; font-size: clamp(20px, 3.2vw, 28px); font-variant-numeric: tabular-nums; }

    /* History list */
    .list{ padding: 6px 12px 14px; }
    .list table{ width:100%; border-collapse: collapse; }
    .list th, .list td{ text-align:left; padding: 10px 8px; font-variant-numeric: tabular-nums; }
    .list thead th{ color: var(--muted); font-size: 12px; text-transform: uppercase; letter-spacing: .12em; border-bottom: 1px solid rgba(255,255,255,.08); }
    .list tbody tr{ border-bottom: 1px dashed rgba(255,255,255,.06); }

    /* Mini chart */
    .chart{ height: 80px; position: relative; margin: 10px 12px 16px; }
    .chart svg{ width:100%; height:100%; display:block; }
    .chart .axis{ stroke: rgba(255,255,255,.12); stroke-width:1; }

    footer{ text-align:center; color: var(--muted); font-size: 12px; padding: 6px 0 8px; }
    a{ color: var(--accent); text-decoration: none; }
    a:hover{ text-decoration: underline; }
  </style>
</head>
<body>
  <div class="app">
    <header class="card">
      <h1>⚡ Reaction Time Tester</h1>
      <p>Click or press <strong>Space</strong> as soon as the screen turns green. Avoid clicking too early!</p>
    </header>

    <div class="grid">
      <!-- Left: Test Area -->
      <section class="card" id="testCard">
        <div class="stage idle" id="stage" role="button" aria-label="Reaction test area" tabindex="0">
          <div class="msg" id="stageMsg">Press <strong>Start</strong> or hit <strong>Space</strong></div>
        </div>
        <div class="controls">
          <div class="left">
            <button class="btn" id="startBtn">Start Test</button>
            <button class="btn secondary" id="resetBtn" title="Clear history and best score">Reset</button>
          </div>
          <div class="hint">Tip: You can use Space/Enter to start and stop.</div>
        </div>
        <div class="stats">
          <div class="stat">
            <div class="label">Current</div>
            <div class="value" id="currentVal">—</div>
          </div>
          <div class="stat">
            <div class="label">Average</div>
            <div class="value" id="avgVal">—</div>
          </div>
          <div class="stat">
            <div class="label">Best</div>
            <div class="value" id="bestVal">—</div>
          </div>
          <div class="stat">
            <div class="label">Attempts</div>
            <div class="value" id="countVal">0</div>
          </div>
        </div>
        <div class="chart" id="chart" aria-hidden="true"></div>
      </section>

      <!-- Right: History -->
      <aside class="card list">
        <table>
          <thead>
            <tr>
              <th>#</th>
              <th>Time (ms)</th>
              <th>When</th>
            </tr>
          </thead>
          <tbody id="rows"></tbody>
        </table>
      </aside>
    </div>

    <footer>Made with ❤️ — Works offline, saves your best score locally.</footer>
  </div>

  <script>
    (function(){
      const stage = document.getElementById('stage');
      const msg = document.getElementById('stageMsg');
      const startBtn = document.getElementById('startBtn');
      const resetBtn = document.getElementById('resetBtn');
      const currentVal = document.getElementById('currentVal');
      const avgVal = document.getElementById('avgVal');
      const bestVal = document.getElementById('bestVal');
      const countVal = document.getElementById('countVal');
      const rows = document.getElementById('rows');
      const chart = document.getElementById('chart');

      const STORAGE_KEY = 'rt-history-v1';
      let state = 'idle'; // 'idle' | 'wait' | 'go'
      let waitTimer = null;
      let goAt = 0;
      let history = loadHistory();

      function loadHistory(){
        try{ return JSON.parse(localStorage.getItem(STORAGE_KEY)) || []; }catch{ return []; }
      }
      function saveHistory(){
        try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(history)); }catch{}
      }

      function fmt(ms){ return Math.round(ms); }
      function now(){ return performance.now(); }

      function setStage(next, text){
        stage.classList.remove('idle','wait','go','too-soon');
        stage.classList.add(next);
        msg.innerHTML = text;
        state = next === 'too-soon' ? 'idle' : next;
      }

      function start(){
        if(state === 'wait') return; // ignore double
        setStage('wait', 'Wait for <strong>green</strong>…');
        currentVal.textContent = '—';
        const delay = 1200 + Math.random()*2000; // 1.2s – 3.2s
        clearTimeout(waitTimer);
        waitTimer = setTimeout(()=>{
          goAt = now();
          setStage('go', 'GO! Click or press <strong>Space</strong>');
        }, delay);
      }

      function tooSoon(){
        clearTimeout(waitTimer);
        setStage('too-soon', 'Too soon! Click <strong>Start</strong> to try again.');
      }

      function record(ms){
        const entry = { ms: fmt(ms), t: Date.now() };
        history.unshift(entry);
        // keep last 50
        if(history.length > 50) history.length = 50;
        saveHistory();
        render();
      }

      function stop(){
        if(state !== 'go') return;
        const rt = now() - goAt;
        setStage('idle', 'Press <strong>Start</strong> or hit <strong>Space</strong>');
        record(rt);
      }

      function reset(){
        history = [];
        saveHistory();
        render();
      }

      function render(){
        // Stats
        countVal.textContent = history.length;
        if(history.length){
          const times = history.map(h=>h.ms);
          const avg = Math.round(times.reduce((a,b)=>a+b,0)/times.length);
          const best = Math.min(...times);
          currentVal.textContent = history[0].ms + ' ms';
          avgVal.textContent = avg + ' ms';
          bestVal.textContent = best + ' ms';
        } else {
          currentVal.textContent = avgVal.textContent = '—';
          bestVal.textContent = '—';
        }
        // Table
        rows.innerHTML = history.map((h,i)=>{
          const d = new Date(h.t);
          const when = d.toLocaleString();
          return `<tr><td>${i+1}</td><td>${h.ms} ms</td><td>${when}</td></tr>`
        }).join('');
        // Chart (last 10)
        drawChart(history.slice(0,10).reverse());
      }

      function drawChart(data){
        chart.innerHTML = '';
        if(!data.length){ return; }
        const max = Math.max(...data.map(d=>d.ms), 300);
        const min = Math.min(...data.map(d=>d.ms), 100);
        const pad = 8;
        const svgNS = 'http://www.w3.org/2000/svg';
        const svg = document.createElementNS(svgNS, 'svg');
        svg.setAttribute('viewBox', `0 0 100 ${100}`);
        // axis line
        const axis = document.createElementNS(svgNS, 'line');
        axis.setAttribute('x1', pad); axis.setAttribute('y1', 96);
        axis.setAttribute('x2', 100-pad); axis.setAttribute('y2', 96);
        axis.setAttribute('class','axis');
        svg.appendChild(axis);
        const n = data.length;
        data.forEach((d, idx)=>{
          const x = pad + (idx+0.5)*( (100-2*pad)/n );
          const h = ( (d.ms - min) / (max - min || 1) ) * 70 + 6;
          const y = 96 - h;
          const bar = document.createElementNS(svgNS, 'rect');
          bar.setAttribute('x', x - 3.5);
          bar.setAttribute('y', y);
          bar.setAttribute('width', 7);
          bar.setAttribute('height', h);
          bar.setAttribute('rx', 2);
          bar.setAttribute('fill', 'rgba(255,255,255,.35)');
          bar.setAttribute('opacity', String(0.6 + 0.35*idx/n));
          svg.appendChild(bar);
        });
        chart.appendChild(svg);
      }

      // Input handlers
      function onPointer(e){
        if(e.type === 'pointerdown'){
          if(state === 'wait') return tooSoon();
          if(state === 'go') return stop();
        }
      }
      function onKey(e){
        if(e.repeat) return;
        if(e.code === 'Space' || e.code === 'Enter'){
          e.preventDefault();
          if(state === 'idle') return start();
          if(state === 'wait') return tooSoon();
          if(state === 'go') return stop();
        }
      }

      // Wire up
      stage.addEventListener('pointerdown', onPointer);
      stage.addEventListener('keydown', onKey);
      startBtn.addEventListener('click', start);
      resetBtn.addEventListener('click', reset);

      // First paint
      render();
    })();
  </script>
</body>
</html>
